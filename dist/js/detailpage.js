"use strict";var _createClass=function(){function h(i,t){for(var s=0;s<t.length;s++){var h=t[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(i,h.key,h)}}return function(i,t,s){return t&&h(i.prototype,t),s&&h(i,s),i}}();function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}$(document).ready(function(){$(".header").load("../dist/header.html"),$(".main").load("../dist/detailpage-main.html"),$(".footer").load("../dist/footer.html");var i=location.search.substring(1).split("=")[1];function t(){_classCallCheck(this,t),this.wrap=$(".wrap"),this.spic=$("#spic"),this.sf=$("#sf"),this.bf=$("#bf"),this.bpic=$("#bpic"),this.ullist=$("#list ul"),this.list=$("#list li"),this.left=$("#left"),this.right=$("#right")}$.ajax({data:{sid:i},type:"post",url:"http://10.31.157.77/800/php/data-detailpage.php",dataType:"json",success:function(i){var t=$(".deteilpic-xr");t.find(".bp").html('\n         <img sid="'+i.sid+'" src="'+i.url+'"\n         style="display: inline;">\n        '),t.find(".sp").html('\n            <li class="">\n               <a href="#">\n                <img src="'+i.url+'" alt="" style="width:58px;height:58px;">\n               </a>\n            </li>\n           '),$(".detail-title").html(""+i.title),$(".detail-xj").html("¥"+i.newprice),$(".detail-yj").html("¥"+i.oldprice),$(".jia").on("click",function(){var i=$("#numb").val();99<=++i&&(i=99),$("#numb").val(i)}),$(".jian").on("click",function(){var i=$("#numb").val();--i<=1&&(i=1),$("#numb").val(i)}),$("#numb").on("input",function(){var i=parseInt($(this).val());/^\d+$/g.test(i)?99<=i?$(this).val(99):i<=0?$(this).val(1):$(this).val(i):$(this).val(1),setcookie($(this))});var s=[],h=[];$(".add-cart").on("click",function(){var i=$(this).parents("#detail").find(".bp img").attr("sid");if(getcookie("cookiesid")&&getcookie("cookienum")&&(s=getcookie("cookiesid").split(","),h=getcookie("cookienum").split(",")),-1!=$.inArray(i,s)){var t=parseInt(h[$.inArray(i,s)])+parseInt($(".sl").find("input").val());h[$.inArray(i,s)]=t,addcookie("cookienum",h.toString(),10)}else s.push(i),addcookie("cookiesid",s.toString(),10),h.push($(".sl").find("input").val()),addcookie("cookienum",h.toString(),10);alert("添加成功")})}}),(_createClass(t,[{key:"init",value:function(){var t=this;this.spic.hover(function(){$("#sf,#bf").css("visibility","visible"),t.spic.on("mousemove",function(i){t.spicmove(i)})},function(){$("#sf,#bf").css("visibility","hidden")}),this.sf.css({width:this.spic.width()*this.bf.width()/this.bpic.width(),height:this.spic.height()*this.bf.height()/this.bpic.height()}),this.bili=this.bpic.width()/this.spic.width(),this.list.on("click",function(){t.changepicurl($(this))}),this.num=6,this.liwidth=this.list.eq(0).outerWidth(),this.list.length<=6&&this.right.css("color","#fff"),this.right.on("click",function(){t.rightclick()}),this.left.on("click",function(){t.leftclick()})}},{key:"spicmove",value:function(i){var t=i.pageX-this.wrap.offset().left-this.sf.width()/2,s=i.pageY-this.wrap.offset().top-this.sf.height()/2;t<0?t=0:t>=this.spic.width()-this.sf.width()&&(t=this.spic.width()-this.sf.width()),s<0?s=0:s>=this.spic.height()-this.sf.height()&&(s=this.spic.height()-this.sf.height()),this.sf.css({left:t,top:s}),this.bpic.css({left:-t*this.bili,top:-s*this.bili})}},{key:"changepicurl",value:function(i){var t=i.find("img").attr("src");this.spic.find("img").attr("src",t),this.bpic.attr("src",t),this.sf.css({width:this.spic.width()*this.bf.width()/this.bpic.width(),height:this.spic.height()*this.bf.height()/this.bpic.height()}),this.bili=this.bpic.width()/this.spic.width()}}]),new t).init()});